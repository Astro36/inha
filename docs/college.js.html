<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: college.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: college.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const jsdom = require('jsdom');
const request = require('request');

const colleges = require('../data/colleges');

/** @module college */

const { JSDOM } = jsdom;

/**
 * Returns a matched college data in the DB.
 * @param {string} name
 * @returns {?College}
 */
const find = name => colleges.find(college => college.name === name) || null;

/**
 * Returns all college data from DB.
 * @returns {Array.&lt;College>}
 */
const getAll = () => colleges;

/**
 * Returns the college information.
 * @async
 * @param {College} college
 * @returns {Promise.&lt;Informaion>}
 */
const getInformation = college => new Promise((resolve, reject) => {
  const { name, pageId, url } = college;
  request(`http://www.inha.ac.kr/mbshome/mbs/kr/subview.do?id=${pageId}`, (err, httpResponse, body) => {
    if (err) {
      reject(err);
    } else {
      const { document } = new JSDOM(body).window;
      const metadata = document.querySelectorAll('.list_03 li');
      if (metadata.length === 3) {
        const [telephone, fax, location] = metadata;
        resolve({
          name,
          description: document.querySelector('.college_h3_text').textContent,
          telephone: telephone.textContent.replace('TEL : ', '').replace(/(\s|\\n|\\t)+/g, ' '),
          fax: fax.textContent.replace('FAX : ', ''),
          location: location.textContent.replace('위치 : ', '').replace(/(\s|\\n|\\t)+/g, ' ').trim(),
          url,
        });
      } else if (metadata.length === 2) {
        const [telephone, location] = metadata;
        resolve({
          name,
          description: document.querySelector('.college_h3_text').textContent,
          telephone: telephone.textContent.replace('TEL : ', '').replace(/(\s|\\n|\\t)+/g, ' '),
          fax: null,
          location: location.textContent.replace('위치 : ', '').replace(/(\s|\\n|\\t)+/g, ' ').trim(),
          url,
        });
      } else {
        reject(new Error('Invalid metadata format'));
      }
    }
  });
});

module.exports = {
  find,
  getAll,
  getInformation,
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-college.html">college</a></li><li><a href="module-department.html">department</a></li><li><a href="module-restaurant.html">restaurant</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Mar 31 2019 16:53:54 GMT+0900 (GMT+09:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
